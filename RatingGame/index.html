<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rating Game</title>
  <link rel="stylesheet" href="style_new.css" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <!-- Intro / Instruction Overlay -->
  <div id="instructionOverlay" class="overlay">
    <div class="instruction-content">
      <p id="introText">Welcome to the Rating Game!</p>
      <div id="participantFields" style="display: none; margin-top: 15px;">
        <label for="participantID">Participant ID:</label><br>
        <input type="text" id="participantID" placeholder="Enter ID" /><br><br>
      </div>
      <button id="startButton">Next</button>
    </div>
  </div>

  <!-- Trial Container -->
  <div id="trialContainer">
    <div id="fixation">+</div>

    <!-- Prompt and image block -->
    <div id="stimulusBlock">
      <div id="stimulusPrompt">Friendly?</div>
      <div id="stimulusImageContainer">
        <img id="stimulusImage" src="" alt="stimulus" />
      </div>
    </div>

    <!-- Desktop key labels -->
    <div id="keyLabelLeft" class="key-label desktop-only">A = No</div>
    <div id="keyLabelRight" class="key-label desktop-only">L = Yes</div>
  </div>

  <!-- Mobile Tap Instructions -->
  <div id="mobileTapReminder" class="mobile-only">
    <span class="mobile-left">Tap left<br>for No</span>
    <span class="mobile-right">Tap right<br>for Yes</span>
  </div>

  <!-- Trial Status -->
  <div id="status"></div>

  <!-- Popup Overlay -->
  <div id="popupOverlay" class="overlay" style="display: none;">
    <div class="popup-content">
      <p id="popupMessage"></p>
      <button id="popupContinue">Continue</button>
    </div>
  </div>

  <!-- KDE Quiz Overlay -->
  <div id="kdeOverlay" class="overlay" style="display:none;">
    <div class="popup-content" style="max-width:720px; max-height:75vh; overflow:auto;">
      <h2 style="margin-top:0;">Question about the images you saw</h2>
      <p style="margin-bottom:10px;">
        Below are two smoothed curves of ratings. One curve summarizes ratings for 
        <strong>profiles you might encounter in the real world</strong>. The other summarizes ratings for the <strong>profiles shown in this experiment</strong>.
        Taller parts of a curve indicate ratings that were more common.
      </p>

      <div style="border:1px solid #ddd; border-radius:10px; padding:12px; margin:12px 0;">
        <canvas id="kdeCanvas" width="660" height="320" style="width:100%; height:auto;"></canvas>
      </div>

      <div style="margin-top:10px;">
        <div style="margin-bottom:8px; font-weight:600;">1) Which curve shows the real-world distribution of ratings?</div>
        <label><input type="radio" name="kde_real_choice" value="black"> Black</label>&nbsp;&nbsp;
        <label><input type="radio" name="kde_real_choice" value="red"> Red</label>
      </div>

      <div style="margin-top:14px;">
        <div style="margin-bottom:8px; font-weight:600;">2) Which curve shows the distribution you experienced in this experiment?</div>
        <label><input type="radio" name="kde_exp_choice" value="black"> Black</label>&nbsp;&nbsp;
        <label><input type="radio" name="kde_exp_choice" value="red"> Red</label>
      </div>

      <div style="margin-top:16px; font-size:13px; color:#555;">
        Note: Itâ€™s okay if you think the <em>same</em> curve is the correct answer for both questions.
      </div>

      <div style="margin-top:18px; display:flex; justify-content:flex-end; gap:10px;">
        <button id="kdeSubmit" disabled>Continue</button>
      </div>
    </div>
  </div>


  <!-- Main Script -->
  <script src="script_new.js"></script>
</body>
</html>